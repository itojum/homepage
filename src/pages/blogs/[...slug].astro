---
import BaseLayout from "@/layouts/BaseLayout.astro";
import BlogDetail from "@/components/pages/blog/BlogDetail.astro";
import { getAllBlogIds, getBlogDetail } from "@/libs/microcms";

export async function getStaticPaths() {
	const ids = await getAllBlogIds();
	return ids.map((id) => ({
		params: { slug: id },
	}));
}

const slug = Astro.params.slug;
const blogId = Array.isArray(slug) ? slug[0] : (slug ?? "");
const blog = await getBlogDetail(blogId, {
	depth: 2,
});
---

<BaseLayout
  title={blog.title}
  description={blog.description}
  image={blog.eyecatch?.url}
  path={`/blogs/${blogId}`}
>
  <BlogDetail blog={blog} />
</BaseLayout>
